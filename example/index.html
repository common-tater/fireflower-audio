<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Fireflower Audio</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div id="app">
    <header>
      <h1>Fireflower Audio</h1>
      <p id="status">Connecting...</p>
    </header>

    <section class="card" id="mode-section">
      <h2>Mode</h2>
      <div class="radio-group">
        <label class="radio-label">
          <input type="radio" name="mode" value="broadcaster" id="mode-broadcaster">
          <span class="radio-custom"></span>
          Broadcaster (Root)
        </label>
        <label class="radio-label">
          <input type="radio" name="mode" value="listener" id="mode-listener" checked>
          <span class="radio-custom"></span>
          Listener
        </label>
      </div>
    </section>

    <section class="card" id="transport-controls">
      <div class="button-row">
        <button id="start-btn" disabled>Start</button>
        <button id="stop-btn" disabled>Stop</button>
      </div>
    </section>

    <section class="card" id="audio-settings">
      <h2>Input & Dynamics</h2>

      <div class="viz-row">
        <div class="viz-box">
          <canvas id="level-meter" width="80" height="140"></canvas>
          <span class="viz-label">Input</span>
        </div>
        <div class="viz-box">
          <canvas id="compressor-curve" width="140" height="140"></canvas>
          <span class="viz-label">Compressor</span>
        </div>
        <div class="viz-box">
          <canvas id="output-meter" width="80" height="140"></canvas>
          <span class="viz-label">Output</span>
        </div>
      </div>

      <div class="slider-row">
        <label for="input-gain">Input Gain</label>
        <input type="range" id="input-gain" min="0.5" max="10" step="0.1" value="1">
        <span id="input-gain-value">1.0x</span>
      </div>
      <div class="setting-row">
        <label class="toggle-label">
          <input type="checkbox" id="compressor-enabled">
          <span class="toggle"></span>
          Compressor / Limiter
        </label>
      </div>
      <div id="compressor-controls">
        <div class="slider-row">
          <label for="compressor-threshold">Threshold</label>
          <input type="range" id="compressor-threshold" min="-40" max="0" step="1" value="-12">
          <span id="compressor-threshold-value">-12 dB</span>
        </div>
        <div class="slider-row">
          <label for="compressor-ratio">Ratio</label>
          <input type="range" id="compressor-ratio" min="1" max="20" step="1" value="12">
          <span id="compressor-ratio-value">12:1</span>
        </div>
      </div>
    </section>

    <section class="card" id="vad-settings">
      <h2>Voice Activity Detection</h2>
      <div class="setting-row">
        <label class="toggle-label">
          <input type="checkbox" id="vad-enabled" checked>
          <span class="toggle"></span>
          Enable VAD
        </label>
      </div>
      <div class="slider-row">
        <label for="vad-threshold">Sensitivity</label>
        <input type="range" id="vad-threshold" min="0.005" max="0.05" step="0.005" value="0.01">
        <span id="vad-threshold-value">High</span>
      </div>
      <p class="setting-hint">Higher sensitivity detects quieter speech but may trigger on background noise.</p>
    </section>

    <section class="card" id="listener-settings">
      <h2>Audio Output</h2>
      <div class="viz-row viz-centered">
        <div class="viz-box">
          <canvas id="listener-output-meter" width="80" height="140"></canvas>
          <span class="viz-label">Output Level</span>
        </div>
      </div>
    </section>

    <section class="card" id="stats">
      <h2>Status</h2>
      <div class="stat-grid">
        <div class="stat" id="vad-indicator">
          <span class="stat-label">VAD</span>
          <span class="stat-value">-</span>
        </div>
        <div class="stat" id="frames-indicator">
          <span class="stat-label">Frames</span>
          <span class="stat-value">0</span>
        </div>
        <div class="stat" id="drops-indicator">
          <span class="stat-label">Drops</span>
          <span class="stat-value">0</span>
        </div>
      </div>
    </section>

    <section class="card" id="tree-info">
      <h2>Tree</h2>
      <div class="info-grid">
        <div class="info-row">
          <span class="info-label">Node ID</span>
          <span class="info-value" id="node-id-value">-</span>
        </div>
        <div class="info-row">
          <span class="info-label">State</span>
          <span class="info-value" id="node-state-value">-</span>
        </div>
        <div class="info-row">
          <span class="info-label">Transport</span>
          <span class="info-value" id="node-transport-value">-</span>
        </div>
        <div class="info-row">
          <span class="info-label">Upstream</span>
          <span class="info-value" id="upstream-value">-</span>
        </div>
        <div class="info-row">
          <span class="info-label">Downstream</span>
          <span class="info-value" id="downstream-value">-</span>
        </div>
      </div>
    </section>
  </div>

  <script src="build.js"></script>
</body>
</html>
